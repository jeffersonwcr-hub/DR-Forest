<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Reporte en Vivo</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, sans-serif;
      margin: 0;
      padding: 0;
      background: #f9f9f9;
      color: #333;
    }
    header {
      background: #2d89ef;
      color: white;
      padding: 20px;
      text-align: center;
    }
    h1 { margin: 0; font-size: 22px; }
    
    .menu {
      display: flex;
      justify-content: center;
      gap: 10px;
      background: #eee;
      padding: 10px;
      flex-wrap: wrap;
    }
    .menu button {
      background: #2d89ef;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .menu button:hover {
      background: #1b5fa7;
    }
    .menu button.active {
      background: #1b5fa7;
      font-weight: bold;
    }

    .tabla-contenedor {
      display: none;
      padding: 20px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: left;
    }
    th {
      background: #f4f4f4;
    }
  </style>
</head>
<body>
  <header>
    <h1>ðŸ“Š Reporte en Vivo desde Google Sheets</h1>
  </header>

  <nav class="menu" id="menu"></nav>
  <div id="contenedor"></div>

  <script>
    const hojas = [
      { nombre: "DEFECTOS SEMANALES", url: "https://docs.google.com/spreadsheets/d/1LVgU072wfENgd3vAW1Ze0Z9NJIWYWiZcGa9idfdVkBA/gviz/tq?tqx=out:json&sheet=DEFECTOS%20SEMANALES" },
      { nombre: "TABLA SO", url: "https://docs.google.com/spreadsheets/d/1LVgU072wfENgd3vAW1Ze0Z9NJIWYWiZcGa9idfdVkBA/gviz/tq?tqx=out:json&sheet=TABLA%20SO" },
      { nombre: "TABLA NO ESCANEABLE", url: "https://docs.google.com/spreadsheets/d/1LVgU072wfENgd3vAW1Ze0Z9NJIWYWiZcGa9idfdVkBA/gviz/tq?tqx=out:json&sheet=TABLA%20NO%20ESCANEABLE" },
      { nombre: "TABLA DE TIEMPOS", url: "https://docs.google.com/spreadsheets/d/1LVgU072wfENgd3vAW1Ze0Z9NJIWYWiZcGa9idfdVkBA/gviz/tq?tqx=out:json&sheet=TABLA%20DE%20TIEMPOS" }
    ];

    const menu = document.getElementById("menu");
    const cont = document.getElementById("contenedor");

    // Crear botones y contenedores
    hojas.forEach((hoja, index) => {
      const btn = document.createElement("button");
      btn.textContent = hoja.nombre;
      btn.onclick = () => mostrarHoja(index);
      menu.appendChild(btn);

      const div = document.createElement("div");
      div.id = "hoja-" + index;
      div.classList.add("tabla-contenedor");
      cont.appendChild(div);

      cargarHoja(hoja, div.id);
    });

    // Mostrar hoja activa
    function mostrarHoja(index) {
      document.querySelectorAll(".tabla-contenedor").forEach(div => div.style.display = "none");
      document.querySelectorAll(".menu button").forEach(btn => btn.classList.remove("active"));

      document.getElementById("hoja-" + index).style.display = "block";
      menu.children[index].classList.add("active");
    }

    // Cargar datos de Google Sheets
    async function cargarHoja(hoja, contenedorId) {
      const res = await fetch(hoja.url);
      const texto = await res.text();
      const json = JSON.parse(texto.substring(47, texto.length - 2));

      const div = document.getElementById(contenedorId);
      const tabla = document.createElement("table");

      // Encabezados
      let header = "<tr>";
      json.table.cols.forEach(col => header += `<th>${col.label}</th>`);
      header += "</tr>";
      tabla.innerHTML = header;

      // Filas
      json.table.rows.forEach(row => {
        let fila = "<tr>";
        row.c.forEach(cell => fila += `<td>${cell ? cell.v : ""}</td>`);
        fila += "</tr>";
        tabla.innerHTML += fila;
      });

      div.appendChild(tabla);
    }

    // Mostrar primero
    mostrarHoja(0);
  </script>
</body>
</html>
